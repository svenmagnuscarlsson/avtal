<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wasa Larm - Digitalt Tj√§nsteavtal</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700&family=Work+Sans:wght@300;400;500;600&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Work Sans', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e8edf2 100%);
            min-height: 100vh;
            color: #1e293b;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1024px;
            margin: 0 auto;
            padding: 2rem 1rem;
        }
        
        .brand-title {
            font-family: 'Playfair Display', serif;
            letter-spacing: -0.02em;
            font-size: 3rem;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 0.5rem;
            text-align: center;
        }
        
        .subtitle {
            text-align: center;
            color: #64748b;
            margin-bottom: 2rem;
        }
        
        .card {
            background: white;
            border-radius: 1rem;
            padding: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 1.5rem;
        }
        
        .progress-container {
            background: white;
            border-radius: 1.5rem;
            padding: 1.5rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            margin-bottom: 2rem;
        }
        
        .steps {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
        }
        
        .step {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }
        
        .step-indicator {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 1.25rem;
            transition: all 0.3s ease;
        }
        
        .step-indicator.active {
            background: #0ea5e9;
            color: white;
            transform: scale(1.1);
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
        }
        
        .step-indicator.completed {
            background: #10b981;
            color: white;
        }
        
        .step-indicator.inactive {
            background: #e2e8f0;
            color: #64748b;
        }
        
        .step-title {
            font-size: 0.875rem;
            text-align: center;
            font-weight: 500;
            color: #64748b;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        @media (min-width: 768px) {
            .form-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .brand-title {
                font-size: 3.5rem;
            }
        }
        
        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 500;
            color: #374151;
            margin-bottom: 0.5rem;
        }
        
        .form-input,
        .form-select {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid #d1d5db;
            border-radius: 0.75rem;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s ease;
            background: white;
        }
        
        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: #0ea5e9;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
            transform: translateY(-1px);
        }
        
        .info-box {
            padding: 1rem;
            border-radius: 0.75rem;
            font-size: 0.875rem;
            border: 2px solid;
        }
        
        .info-box.sky {
            background: #f0f9ff;
            border-color: #bae6fd;
            color: #0c4a6e;
        }
        
        .info-box.amber {
            background: #fffbeb;
            border-color: #fde68a;
            color: #78350f;
        }
        
        .payment-options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 0.75rem;
        }
        
        @media (min-width: 768px) {
            .payment-options {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .payment-option {
            padding: 1rem 1.5rem;
            border: 2px solid #d1d5db;
            border-radius: 0.75rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            text-align: center;
            background: white;
        }
        
        .payment-option:hover {
            border-color: #0ea5e9;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }
        
        .payment-option.selected {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border-color: #0284c7;
        }
        
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1.5rem;
        }
        
        .service-card {
            padding: 1.25rem;
            border: 2px solid #e5e7eb;
            border-radius: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            margin-bottom: 0.75rem;
            background: white;
        }
        
        .service-card:hover {
            border-color: #0ea5e9;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
        }
        
        .service-card.selected {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            border-color: #0284c7;
        }
        
        .service-header {
            display: flex;
            align-items: flex-start;
            gap: 1rem;
        }
        
        .checkbox {
            width: 24px;
            height: 24px;
            border-radius: 6px;
            border: 2px solid #d1d5db;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }
        
        .service-card.selected .checkbox {
            background: white;
            border-color: white;
        }
        
        .checkbox-check {
            color: #0ea5e9;
            font-weight: bold;
            font-size: 1.125rem;
        }
        
        .service-title {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .service-description {
            font-size: 0.875rem;
            opacity: 0.9;
        }
        
        .signature-section {
            background: white;
            padding: 1.5rem;
            border-radius: 1rem;
            border: 2px solid #e5e7eb;
            margin-bottom: 1.5rem;
        }
        
        .signature-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 1.5rem;
        }
        
        .signature-canvas {
            border: 2px dashed #cbd5e1;
            background: white;
            border-radius: 0.75rem;
            touch-action: none;
            cursor: crosshair;
            transition: all 0.3s ease;
            width: 100%;
            display: block;
        }
        
        .signature-canvas:hover {
            border-color: #0ea5e9;
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
        }
        
        .btn {
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            font-size: 1rem;
            font-family: inherit;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(14, 165, 233, 0.4);
        }
        
        .btn-primary:active {
            transform: translateY(0);
        }
        
        .btn-secondary {
            background: white;
            color: #374151;
            border: 2px solid #d1d5db;
        }
        
        .btn-secondary:hover {
            background: #f9fafb;
            border-color: #9ca3af;
        }
        
        .btn-text {
            background: transparent;
            color: #0ea5e9;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }
        
        .btn-text:hover {
            color: #0284c7;
        }
        
        .nav-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .nav-buttons .btn {
            flex: 1;
        }
        
        .nav-buttons .btn-secondary {
            flex: none;
            padding: 1rem 1.5rem;
        }
        
        .save-indicator {
            text-align: center;
            color: #64748b;
            font-size: 0.875rem;
            margin-top: 1rem;
        }
        
        .review-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }
        
        @media (min-width: 768px) {
            .review-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .review-item {
            margin-bottom: 0.75rem;
        }
        
        .review-label {
            font-weight: 600;
            display: inline;
        }
        
        .success-header {
            background: linear-gradient(135deg, #0ea5e9 0%, #0284c7 100%);
            color: white;
            padding: 2rem;
            border-radius: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .success-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .success-subtitle {
            opacity: 0.9;
        }
        
        .service-list {
            list-style: none;
        }
        
        .service-list-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
            font-size: 0.875rem;
        }
        
        .check-icon {
            color: #10b981;
        }
        
        .signature-preview {
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            max-height: 100px;
            margin-top: 0.5rem;
        }
        
        .review-signature-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }
        
        @media (min-width: 768px) {
            .review-signature-grid {
                grid-template-columns: 1fr 1fr;
            }
        }
        
        .export-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .export-buttons .btn {
            flex: 1;
            min-width: 200px;
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-in {
            animation: slideIn 0.4s ease-out;
        }
        
        @media (max-width: 640px) {
            .brand-title {
                font-size: 2rem;
            }
            
            .step-title {
                font-size: 0.75rem;
            }
            
            .step-indicator {
                width: 40px;
                height: 40px;
                font-size: 1rem;
            }
            
            .card {
                padding: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useRef, useEffect } = React;

        const TjansteavtalApp = () => {
            const [currentStep, setCurrentStep] = useState(0);
            const [formData, setFormData] = useState({
                objektsnummer: '222590-1',
                kundnamn: '',
                kundnr: '222590',
                objektnamn: '',
                orgnr: '',
                objektadress: '',
                postnummer: '',
                postort: '',
                fakturaadress: '',
                telefon: '',
                kontaktperson: '',
                telefonKontakt: '',
                email: '',
                avtalsstart: '',
                avtalsperiod: '24',
                betalningsvillkor: 'kvartalsvis',
                inbrottslarm: false,
                grundservice: false,
                larmformedling: false,
                friaVaktarutryckningar: false,
                larmsandare: false,
                utokadGaranti36: false,
                hyresavtal: false,
                cctv: false,
                cctvGrundservice: false,
                mobildata: false,
                cctvGaranti: false,
                firePreventionKomplett: false,
                brandlarm: false,
                saljarSignatur: null,
                kundSignatur: null,
                saljarNamn: '',
                kundNamn: '',
                saljarDatum: '',
                kundDatum: ''
            });

            const saljarCanvasRef = useRef(null);
            const kundCanvasRef = useRef(null);
            const [isSaljarDrawing, setIsSaljarDrawing] = useState(false);
            const [isKundDrawing, setIsKundDrawing] = useState(false);

            useEffect(() => {
                const saved = localStorage.getItem('tjansteavtal-draft');
                if (saved) {
                    setFormData(JSON.parse(saved));
                }
            }, []);

            useEffect(() => {
                localStorage.setItem('tjansteavtal-draft', JSON.stringify(formData));
            }, [formData]);

            const updateField = (field, value) => {
                setFormData(prev => ({ ...prev, [field]: value }));
            };

            const steps = [
                { title: 'Kundinformation', icon: 'üë§' },
                { title: 'Avtalsinformation', icon: 'üìã' },
                { title: 'Tj√§nster', icon: 'üõ°Ô∏è' },
                { title: 'Underskrifter', icon: '‚úçÔ∏è' },
                { title: 'Granska', icon: '‚úì' }
            ];

            const startDrawing = (e, canvas, setDrawing) => {
                setDrawing(true);
                const ctx = canvas.getContext('2d');
                ctx.beginPath();
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.moveTo(x, y);
            };

            const draw = (e, canvas, isDrawing) => {
                if (!isDrawing) return;
                e.preventDefault();
                const ctx = canvas.getContext('2d');
                const rect = canvas.getBoundingClientRect();
                const x = (e.clientX || e.touches[0].clientX) - rect.left;
                const y = (e.clientY || e.touches[0].clientY) - rect.top;
                ctx.lineTo(x, y);
                ctx.strokeStyle = '#1e293b';
                ctx.lineWidth = 2;
                ctx.lineCap = 'round';
                ctx.stroke();
            };

            const stopDrawing = (canvas, field, setDrawing) => {
                setDrawing(false);
                updateField(field, canvas.toDataURL());
            };

            const clearSignature = (canvas, field) => {
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                updateField(field, null);
            };

            const renderKundinformation = () => (
                <div className="animate-in">
                    <div className="form-grid">
                        <div className="form-group">
                            <label className="form-label">Kundnamn *</label>
                            <input
                                type="text"
                                value={formData.kundnamn}
                                onChange={(e) => updateField('kundnamn', e.target.value)}
                                className="form-input"
                                placeholder="T.ex. G√•rdstensbost√§der AB"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Organisationsnummer *</label>
                            <input
                                type="text"
                                value={formData.orgnr}
                                onChange={(e) => updateField('orgnr', e.target.value)}
                                className="form-input"
                                placeholder="XXXXXX-XXXX"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Objektnamn *</label>
                            <input
                                type="text"
                                value={formData.objektnamn}
                                onChange={(e) => updateField('objektnamn', e.target.value)}
                                className="form-input"
                                placeholder="Objektets namn"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Telefon *</label>
                            <input
                                type="tel"
                                value={formData.telefon}
                                onChange={(e) => updateField('telefon', e.target.value)}
                                className="form-input"
                                placeholder="031-XXX XX XX"
                            />
                        </div>
                    </div>
                    
                    <div className="form-group">
                        <label className="form-label">Objektadress *</label>
                        <input
                            type="text"
                            value={formData.objektadress}
                            onChange={(e) => updateField('objektadress', e.target.value)}
                            className="form-input"
                            placeholder="Gatuadress"
                        />
                    </div>
                    
                    <div className="form-grid">
                        <div className="form-group">
                            <label className="form-label">Postnummer</label>
                            <input
                                type="text"
                                value={formData.postnummer}
                                onChange={(e) => updateField('postnummer', e.target.value)}
                                className="form-input"
                                placeholder="XXX XX"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Postort</label>
                            <input
                                type="text"
                                value={formData.postort}
                                onChange={(e) => updateField('postort', e.target.value)}
                                className="form-input"
                                placeholder="T.ex. G√∂teborg"
                            />
                        </div>
                    </div>
                    
                    <div className="form-group">
                        <label className="form-label">Kontaktperson</label>
                        <input
                            type="text"
                            value={formData.kontaktperson}
                            onChange={(e) => updateField('kontaktperson', e.target.value)}
                            className="form-input"
                            placeholder="Namn p√• kontaktperson"
                        />
                    </div>
                    
                    <div className="form-grid">
                        <div className="form-group">
                            <label className="form-label">Telefon kontaktperson</label>
                            <input
                                type="tel"
                                value={formData.telefonKontakt}
                                onChange={(e) => updateField('telefonKontakt', e.target.value)}
                                className="form-input"
                                placeholder="07X-XXX XX XX"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">E-postadress</label>
                            <input
                                type="email"
                                value={formData.email}
                                onChange={(e) => updateField('email', e.target.value)}
                                className="form-input"
                                placeholder="exempel@f√∂retag.se"
                            />
                        </div>
                    </div>
                </div>
            );

            const renderAvtalsinformation = () => (
                <div className="animate-in">
                    <div className="form-grid">
                        <div className="form-group">
                            <label className="form-label">Avtalsstart *</label>
                            <input
                                type="date"
                                value={formData.avtalsstart}
                                onChange={(e) => updateField('avtalsstart', e.target.value)}
                                className="form-input"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Avtalsperiod (m√•nader) *</label>
                            <select
                                value={formData.avtalsperiod}
                                onChange={(e) => updateField('avtalsperiod', e.target.value)}
                                className="form-select"
                            >
                                <option value="12">12 m√•nader</option>
                                <option value="24">24 m√•nader</option>
                                <option value="36">36 m√•nader</option>
                                <option value="48">48 m√•nader</option>
                            </select>
                        </div>
                    </div>
                    
                    <div className="form-group">
                        <label className="form-label">Betalningsvillkor *</label>
                        <div className="payment-options">
                            {['kvartalsvis', 'halv√•rsvis', '√•rsvis'].map(option => (
                                <button
                                    key={option}
                                    type="button"
                                    onClick={() => updateField('betalningsvillkor', option)}
                                    className={`payment-option ${formData.betalningsvillkor === option ? 'selected' : ''}`}
                                >
                                    {option.charAt(0).toUpperCase() + option.slice(1)}
                                </button>
                            ))}
                        </div>
                    </div>
                    
                    <div className="info-box sky">
                        <strong>Viktigt:</strong> Om inte avtalet s√§gs upp tre (3) m√•nader innan avtalstidens utg√•ng f√∂rl√§ngs avtalstiden med tolv (12) m√•nader.
                    </div>
                </div>
            );

            const ServiceCard = ({ title, checked, onChange, children }) => (
                <div
                    onClick={() => onChange(!checked)}
                    className={`service-card ${checked ? 'selected' : ''}`}
                >
                    <div className="service-header">
                        <div className="checkbox">
                            {checked && <span className="checkbox-check">‚úì</span>}
                        </div>
                        <div style={{ flex: 1 }}>
                            <div className="service-title">{title}</div>
                            <div className="service-description">{children}</div>
                        </div>
                    </div>
                </div>
            );

            const renderTjanster = () => (
                <div className="animate-in">
                    <div style={{ marginBottom: '2rem' }}>
                        <h3 className="section-title">Inbrottslarm & √ñvervakning</h3>
                        <ServiceCard 
                            title="Inbrottslarm/√ñverfallslarm/Driftslarm"
                            checked={formData.inbrottslarm}
                            onChange={(val) => updateField('inbrottslarm', val)}
                        >
                            Grundl√§ggande larmfunktionalitet
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Grundservice enligt kontrollpunkter"
                            checked={formData.grundservice}
                            onChange={(val) => updateField('grundservice', val)}
                        >
                            Regelbunden service och underh√•ll
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Larmf√∂rmedling till certifierad larmcentral"
                            checked={formData.larmformedling}
                            onChange={(val) => updateField('larmformedling', val)}
                        >
                            F√∂rmedling till max 3 kontaktpersoner, nyckelf√∂rvaring och utryckningsberedskap
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Fria v√§ktarutryckningar"
                            checked={formData.friaVaktarutryckningar}
                            onChange={(val) => updateField('friaVaktarutryckningar', val)}
                        >
                            Se s√§rskilda avtalsvillkor
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Abonnemang f√∂r larms√§ndare"
                            checked={formData.larmsandare}
                            onChange={(val) => updateField('larmsandare', val)}
                        >
                            Med √∂vervakad kommunikation
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Ut√∂kad garanti 36 m√•nader"
                            checked={formData.utokadGaranti36}
                            onChange={(val) => updateField('utokadGaranti36', val)}
                        >
                            Vid nyinstallation
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Hyresavtal"
                            checked={formData.hyresavtal}
                            onChange={(val) => updateField('hyresavtal', val)}
                        >
                            Larmequipment ing√•r i hyra
                        </ServiceCard>
                    </div>
                    
                    <div style={{ marginBottom: '2rem' }}>
                        <h3 className="section-title">CCTV - Video√∂vervakning</h3>
                        <ServiceCard 
                            title="CCTV System"
                            checked={formData.cctv}
                            onChange={(val) => updateField('cctv', val)}
                        >
                            Kamerasystem f√∂r video√∂vervakning
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Grundservice f√∂r CCTV"
                            checked={formData.cctvGrundservice}
                            onChange={(val) => updateField('cctvGrundservice', val)}
                        >
                            Regelbunden service enligt kontrollpunkter
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Abonnemang mobildata 3G/4G"
                            checked={formData.mobildata}
                            onChange={(val) => updateField('mobildata', val)}
                        >
                            F√∂r fj√§rr√∂vervakning via mobilt n√§tverk
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Ut√∂kad garanti CCTV"
                            checked={formData.cctvGaranti}
                            onChange={(val) => updateField('cctvGaranti', val)}
                        >
                            36 m√•naders garanti vid nyinstallation
                        </ServiceCard>
                    </div>
                    
                    <div>
                        <h3 className="section-title">Brandskydd</h3>
                        <ServiceCard 
                            title="Fire Prevention Komplett"
                            checked={formData.firePreventionKomplett}
                            onChange={(val) => updateField('firePreventionKomplett', val)}
                        >
                            Omfattande brandskyddsl√∂sning
                        </ServiceCard>
                        
                        <ServiceCard 
                            title="Brandlarm"
                            checked={formData.brandlarm}
                            onChange={(val) => updateField('brandlarm', val)}
                        >
                            Brandlarm enligt SBF110
                        </ServiceCard>
                    </div>
                </div>
            );

            const renderUnderskrifter = () => (
                <div className="animate-in">
                    <div className="signature-section">
                        <h3 className="signature-title">S√§ljare (Wasa Larm AB)</h3>
                        
                        <div className="form-group">
                            <label className="form-label">Namn *</label>
                            <input
                                type="text"
                                value={formData.saljarNamn}
                                onChange={(e) => updateField('saljarNamn', e.target.value)}
                                className="form-input"
                                placeholder="Fyll i ditt namn"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Datum *</label>
                            <input
                                type="date"
                                value={formData.saljarDatum}
                                onChange={(e) => updateField('saljarDatum', e.target.value)}
                                className="form-input"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">
                                Signatur * <span style={{ color: '#64748b', fontSize: '0.75rem' }}>(Rita med finger/penna)</span>
                            </label>
                            <canvas
                                ref={saljarCanvasRef}
                                width={600}
                                height={200}
                                className="signature-canvas"
                                onMouseDown={(e) => startDrawing(e, saljarCanvasRef.current, setIsSaljarDrawing)}
                                onMouseMove={(e) => draw(e, saljarCanvasRef.current, isSaljarDrawing)}
                                onMouseUp={() => stopDrawing(saljarCanvasRef.current, 'saljarSignatur', setIsSaljarDrawing)}
                                onMouseLeave={() => stopDrawing(saljarCanvasRef.current, 'saljarSignatur', setIsSaljarDrawing)}
                                onTouchStart={(e) => startDrawing(e, saljarCanvasRef.current, setIsSaljarDrawing)}
                                onTouchMove={(e) => draw(e, saljarCanvasRef.current, isSaljarDrawing)}
                                onTouchEnd={() => stopDrawing(saljarCanvasRef.current, 'saljarSignatur', setIsSaljarDrawing)}
                            />
                            <button
                                type="button"
                                onClick={() => clearSignature(saljarCanvasRef.current, 'saljarSignatur')}
                                className="btn btn-text"
                            >
                                Rensa signatur
                            </button>
                        </div>
                    </div>
                    
                    <div className="signature-section">
                        <h3 className="signature-title">Kund</h3>
                        
                        <div className="form-group">
                            <label className="form-label">Namn *</label>
                            <input
                                type="text"
                                value={formData.kundNamn}
                                onChange={(e) => updateField('kundNamn', e.target.value)}
                                className="form-input"
                                placeholder="Kundens namn"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">Datum *</label>
                            <input
                                type="date"
                                value={formData.kundDatum}
                                onChange={(e) => updateField('kundDatum', e.target.value)}
                                className="form-input"
                            />
                        </div>
                        
                        <div className="form-group">
                            <label className="form-label">
                                Signatur * <span style={{ color: '#64748b', fontSize: '0.75rem' }}>(Rita med finger/penna)</span>
                            </label>
                            <canvas
                                ref={kundCanvasRef}
                                width={600}
                                height={200}
                                className="signature-canvas"
                                onMouseDown={(e) => startDrawing(e, kundCanvasRef.current, setIsKundDrawing)}
                                onMouseMove={(e) => draw(e, kundCanvasRef.current, isKundDrawing)}
                                onMouseUp={() => stopDrawing(kundCanvasRef.current, 'kundSignatur', setIsKundDrawing)}
                                onMouseLeave={() => stopDrawing(kundCanvasRef.current, 'kundSignatur', setIsKundDrawing)}
                                onTouchStart={(e) => startDrawing(e, kundCanvasRef.current, setIsKundDrawing)}
                                onTouchMove={(e) => draw(e, kundCanvasRef.current, isKundDrawing)}
                                onTouchEnd={() => stopDrawing(kundCanvasRef.current, 'kundSignatur', setIsKundDrawing)}
                            />
                            <button
                                type="button"
                                onClick={() => clearSignature(kundCanvasRef.current, 'kundSignatur')}
                                className="btn btn-text"
                            >
                                Rensa signatur
                            </button>
                        </div>
                    </div>
                    
                    <div className="info-box amber">
                        <strong>OBS:</strong> Genom att signera accepterar ni Wasa Larms Allm√§nna best√§mmelser samt S√§rskilda best√§mmelser f√∂r k√∂p, installation och service av tekniskt s√§kerhetssystem.
                    </div>
                </div>
            );

            const renderGranska = () => {
                const selectedServices = [];
                if (formData.inbrottslarm) selectedServices.push('Inbrottslarm/√ñverfallslarm/Driftslarm');
                if (formData.grundservice) selectedServices.push('Grundservice');
                if (formData.larmformedling) selectedServices.push('Larmf√∂rmedling');
                if (formData.cctv) selectedServices.push('CCTV');
                if (formData.brandlarm) selectedServices.push('Brandlarm');
                
                return (
                    <div className="animate-in">
                        <div className="success-header">
                            <h2 className="success-title">Avtalet √§r klart!</h2>
                            <p className="success-subtitle">Granska informationen nedan innan du slutf√∂r</p>
                        </div>
                        
                        <div className="card">
                            <h3 className="section-title">Kundinformation</h3>
                            <div className="review-grid">
                                <div className="review-item">
                                    <span className="review-label">Kundnamn:</span> {formData.kundnamn}
                                </div>
                                <div className="review-item">
                                    <span className="review-label">Org.nr:</span> {formData.orgnr}
                                </div>
                                <div className="review-item">
                                    <span className="review-label">Objektnamn:</span> {formData.objektnamn}
                                </div>
                                <div className="review-item">
                                    <span className="review-label">Telefon:</span> {formData.telefon}
                                </div>
                                <div className="review-item" style={{ gridColumn: '1 / -1' }}>
                                    <span className="review-label">Adress:</span> {formData.objektadress}, {formData.postnummer} {formData.postort}
                                </div>
                            </div>
                        </div>
                        
                        <div className="card">
                            <h3 className="section-title">Avtalsinformation</h3>
                            <div className="review-grid">
                                <div className="review-item">
                                    <span className="review-label">Avtalsstart:</span> {formData.avtalsstart}
                                </div>
                                <div className="review-item">
                                    <span className="review-label">Avtalsperiod:</span> {formData.avtalsperiod} m√•nader
                                </div>
                                <div className="review-item">
                                    <span className="review-label">Betalning:</span> {formData.betalningsvillkor}
                                </div>
                            </div>
                        </div>
                        
                        <div className="card">
                            <h3 className="section-title">Valda tj√§nster</h3>
                            {selectedServices.length > 0 ? (
                                <ul className="service-list">
                                    {selectedServices.map((service, idx) => (
                                        <li key={idx} className="service-list-item">
                                            <span className="check-icon">‚úì</span>
                                            {service}
                                        </li>
                                    ))}
                                </ul>
                            ) : (
                                <p style={{ color: '#64748b', fontSize: '0.875rem' }}>Inga tj√§nster valda</p>
                            )}
                        </div>
                        
                        <div className="card">
                            <h3 className="section-title">Underskrifter</h3>
                            <div className="review-signature-grid">
                                <div>
                                    <p style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>S√§ljare</p>
                                    <p style={{ fontSize: '0.875rem', marginBottom: '0.5rem' }}>{formData.saljarNamn}</p>
                                    {formData.saljarSignatur && (
                                        <img src={formData.saljarSignatur} alt="S√§ljarsignatur" className="signature-preview" />
                                    )}
                                    <p style={{ fontSize: '0.75rem', color: '#64748b', marginTop: '0.25rem' }}>{formData.saljarDatum}</p>
                                </div>
                                <div>
                                    <p style={{ fontSize: '0.875rem', fontWeight: '500', marginBottom: '0.5rem' }}>Kund</p>
                                    <p style={{ fontSize: '0.875rem', marginBottom: '0.5rem' }}>{formData.kundNamn}</p>
                                    {formData.kundSignatur && (
                                        <img src={formData.kundSignatur} alt="Kundsignatur" className="signature-preview" />
                                    )}
                                    <p style={{ fontSize: '0.75rem', color: '#64748b', marginTop: '0.25rem' }}>{formData.kundDatum}</p>
                                </div>
                            </div>
                        </div>
                        
                        <div className="export-buttons">
                            <button
                                onClick={exportToPDF}
                                className="btn btn-primary"
                            >
                                üìÑ Exportera till PDF
                            </button>
                            <button
                                onClick={() => {
                                    if (confirm('√Ñr du s√§ker p√• att du vill rensa alla uppgifter?')) {
                                        localStorage.removeItem('tjansteavtal-draft');
                                        window.location.reload();
                                    }
                                }}
                                className="btn btn-secondary"
                            >
                                üóëÔ∏è Rensa
                            </button>
                        </div>
                    </div>
                );
            };

            const exportToPDF = () => {
                alert('PDF-export funktion kommer att implementeras med jsPDF eller server-side API.');
            };

            const renderStep = () => {
                switch(currentStep) {
                    case 0: return renderKundinformation();
                    case 1: return renderAvtalsinformation();
                    case 2: return renderTjanster();
                    case 3: return renderUnderskrifter();
                    case 4: return renderGranska();
                    default: return null;
                }
            };

            return (
                <div className="container">
                    <div style={{ textAlign: 'center', marginBottom: '2rem' }}>
                        <h1 className="brand-title">Wasa Larm</h1>
                        <p className="subtitle">Digitalt Tj√§nsteavtal</p>
                    </div>
                    
                    <div className="progress-container">
                        <div className="steps">
                            {steps.map((step, idx) => (
                                <div key={idx} className="step">
                                    <div className={`step-indicator ${
                                        idx === currentStep ? 'active' : 
                                        idx < currentStep ? 'completed' : 'inactive'
                                    }`}>
                                        {idx < currentStep ? '‚úì' : step.icon}
                                    </div>
                                    <p className="step-title">{step.title}</p>
                                </div>
                            ))}
                        </div>
                    </div>
                    
                    <div className="card">
                        {renderStep()}
                    </div>
                    
                    <div className="nav-buttons">
                        {currentStep > 0 && (
                            <button
                                onClick={() => setCurrentStep(currentStep - 1)}
                                className="btn btn-secondary"
                            >
                                ‚Üê Tillbaka
                            </button>
                        )}
                        {currentStep < steps.length - 1 && (
                            <button
                                onClick={() => setCurrentStep(currentStep + 1)}
                                className="btn btn-primary"
                            >
                                N√§sta ‚Üí
                            </button>
                        )}
                    </div>
                    
                    <p className="save-indicator">üíæ Dina √§ndringar sparas automatiskt</p>
                </div>
            );
        };

        ReactDOM.render(<TjansteavtalApp />, document.getElementById('root'));
    </script>
</body>
</html>
